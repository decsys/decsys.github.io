"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[648],{4852:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(9231);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=o,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||r;return n?a.createElement(h,i(i({ref:t},d),{},{components:n})):a.createElement(h,i({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7231:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>p,toc:()=>u});var a=n(2208),o=n(9161),r=(n(9231),n(4852)),i=["components"],s={title:"Hosted Mode"},l=void 0,p={unversionedId:"devs/technical/hosted",id:"devs/technical/hosted",title:"Hosted Mode",description:"In Hosted mode, DECSYS is designed to run as a typical web application, on a typical sort of infrastructure.",source:"@site/docs/devs/technical/hosted.md",sourceDirName:"devs/technical",slug:"/devs/technical/hosted",permalink:"/docs/devs/technical/hosted",editUrl:"https://github.com/decsys/decsys/edit/master/docs/docs/devs/technical/hosted.md",tags:[],version:"current",frontMatter:{title:"Hosted Mode"},sidebar:"technical",previous:{title:"Workshop Mode",permalink:"/docs/devs/technical/workshop"}},d={},u=[{value:"DECSYS App",id:"decsys-app",level:3},{value:"Image Storage",id:"image-storage",level:3},{value:"Identity",id:"identity",level:3},{value:"Database",id:"database",level:3},{value:"Webhooks",id:"webhooks",level:3},{value:"Enabling Webhooks in Development Mode",id:"enabling-webhooks-in-development-mode",level:4},{value:"Example Configuration",id:"example-configuration",level:4},{value:"Notes",id:"notes",level:4}],c={toc:u};function m(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"In ",(0,r.kt)("strong",{parentName:"p"},"Hosted")," mode, DECSYS is designed to run as a typical web application, on a typical sort of infrastructure."),(0,r.kt)("p",null,"The expected infrastructure at this time consists of:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A web server for the DECSYS App itself"),(0,r.kt)("li",{parentName:"ul"},"A MongoDB server for the app databases")),(0,r.kt)("h3",{id:"decsys-app"},"DECSYS App"),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},".NET Backend API")," is a web application:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"It hosts and serves the Frontend Web App."),(0,r.kt)("li",{parentName:"ul"},"It hosts and serves Custom Response Items."),(0,r.kt)("li",{parentName:"ul"},"It hosts a built in Identity Provider to manage user access."),(0,r.kt)("li",{parentName:"ul"},"In Hosted mode in Production, it ",(0,r.kt)("strong",{parentName:"li"},"should be run over HTTPS"),".")),(0,r.kt)("p",null,"You can host it however you prefer:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"It is capable of self-hosting, binding to HTTP/HTTPS on any suitable ports."),(0,r.kt)("li",{parentName:"ul"},"You can put it behind a reverse proxy such as nginx, Apache, IIS etc."),(0,r.kt)("li",{parentName:"ul"},"You can run it in Docker. ",(0,r.kt)("a",{parentName:"li",href:"https://hub.docker.com/_/microsoft-dotnet-nightly-aspnet/"},"Start here")),(0,r.kt)("li",{parentName:"ul"},"You can host it in the Cloud",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"For example, in Azure:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Deploy DECSYS to Azure App Service"),(0,r.kt)("li",{parentName:"ul"},"Use SendGrid in Azure for email"),(0,r.kt)("li",{parentName:"ul"},"Use MongoDB for the Database and Image Storage!")))))),(0,r.kt)("h3",{id:"image-storage"},"Image Storage"),(0,r.kt)("p",null,"Images are served by the Backend API, but they may need to be stored differently, depending on your hosting approach."),(0,r.kt)("p",null,"Currently, the Backend API stores images in the same MongoDB database as everything else, using GridFS. In future, using other stores may be possible (e.g. Azure StorageAccount)."),(0,r.kt)("h3",{id:"identity"},"Identity"),(0,r.kt)("p",null,"The Backend API stores all user details in the primary database ",(0,r.kt)("inlineCode",{parentName:"p"},"decsys"),".\nIt always ensures a single super user (",(0,r.kt)("inlineCode",{parentName:"p"},"admin@localhost"),") is present, with a username and password configured on the hosting environment."),(0,r.kt)("p",null,"That user has ",(0,r.kt)("strong",{parentName:"p"},"Admin")," access and can create ",(0,r.kt)("strong",{parentName:"p"},"Surveys"),"."),(0,r.kt)("p",null,"Additional users can be registered, and will also be ",(0,r.kt)("strong",{parentName:"p"},"Admin")," users who can create ",(0,r.kt)("strong",{parentName:"p"},"Surveys"),"."),(0,r.kt)("p",null,"The Identity service is an Open ID Connect compliant Token provider, currently using only its own userstore, and supporting just a single client: the Frontend Web App."),(0,r.kt)("h3",{id:"database"},"Database"),(0,r.kt)("p",null,"All other data is stored in a remote MongoDB database (",(0,r.kt)("inlineCode",{parentName:"p"},"4.x")," or newer), to which the Backend API connects."),(0,r.kt)("p",null,"Currently Survey configuration data and Survey Instance metadata are stored in a primary database called ",(0,r.kt)("inlineCode",{parentName:"p"},"decsys"),", and Participant Event Logs are stored in a separate database per Survey Instance. Each of these databases is prefixed ",(0,r.kt)("inlineCode",{parentName:"p"},"decsys_events_"),"."),(0,r.kt)("h3",{id:"webhooks"},"Webhooks"),(0,r.kt)("p",null,"DECSYS supports webhooks to facilitate integration with external services. By default, ",(0,r.kt)("strong",{parentName:"p"},"triggering webhooks is blocked during development mode")," to prevent unintended external calls. Developers can enable webhooks and override the webhook URL during development for testing purposes."),(0,r.kt)("h4",{id:"enabling-webhooks-in-development-mode"},"Enabling Webhooks in Development Mode"),(0,r.kt)("p",null,"To enable webhooks during development, adjust the ",(0,r.kt)("inlineCode",{parentName:"p"},"Webhooks")," configuration section in your ",(0,r.kt)("inlineCode",{parentName:"p"},"appsettings.json")," or environment-specific configuration files."),(0,r.kt)("h4",{id:"example-configuration"},"Example Configuration"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "Webhooks": {\n    "OverrideWebhookForDev": true,\n    "GlobalRedirectUrl": "https://webhook.site/your-unique-url"\n  }\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"OverrideWebhookForDev"),": ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"true"),": Allows webhooks to be triggered during development mode. You can also specify a ",(0,r.kt)("inlineCode",{parentName:"li"},"GlobalRedirectUrl")," to override all webhook URLs for testing purposes."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"false"),": Webhooks will behave as configured in the web application without any overrides. This means that if the webhooks are set up in the app, they will function normally even in development mode."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"GlobalRedirectUrl"),": ",(0,r.kt)("em",{parentName:"li"},"(Optional)")," Specify a URL to which all webhook calls will be redirected. This is useful for testing webhooks without invoking actual external services.")),(0,r.kt)("h4",{id:"notes"},"Notes"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Default Behavior in Development Mode:")," If ",(0,r.kt)("inlineCode",{parentName:"p"},"OverrideWebhookForDev")," is not set or is set to false, webhooks will be blocked during development mode to prevent unintended external calls.\n",(0,r.kt)("strong",{parentName:"p"},"Security Considerations"),": Enabling webhooks in development should be done cautiously, especially if the webhooks perform sensitive operations.\n",(0,r.kt)("strong",{parentName:"p"},"Testing Tools"),": Services like webhook.site can be used to receive and inspect webhook payloads for testing purposes."))}m.isMDXComponent=!0}}]);